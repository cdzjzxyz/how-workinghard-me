{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, createTextVNode as _createTextVNode, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, normalizeClass as _normalizeClass, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"stat-block attend\"\n};\nconst _hoisted_2 = {\n  class: \"stat-block late\"\n};\nconst _hoisted_3 = {\n  class: \"stat-block early\"\n};\nconst _hoisted_4 = {\n  class: \"stat-block absent\"\n};\nconst _hoisted_5 = {\n  class: \"stat-block leave\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_date_picker = _resolveComponent(\"el-date-picker\");\n  const _component_el_form_item = _resolveComponent(\"el-form-item\");\n  const _component_el_button = _resolveComponent(\"el-button\");\n  const _component_el_form = _resolveComponent(\"el-form\");\n  const _component_el_alert = _resolveComponent(\"el-alert\");\n  const _component_el_col = _resolveComponent(\"el-col\");\n  const _component_el_row = _resolveComponent(\"el-row\");\n  const _component_el_table_column = _resolveComponent(\"el-table-column\");\n  const _component_el_table = _resolveComponent(\"el-table\");\n  return _openBlock(), _createElementBlock(\"div\", null, [_createVNode(_component_el_form, {\n    inline: true,\n    style: {\n      \"margin-bottom\": \"18px\"\n    }\n  }, {\n    default: _withCtx(() => [_createVNode(_component_el_form_item, {\n      label: \"月份\"\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_date_picker, {\n        modelValue: $setup.month,\n        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.month = $event),\n        type: \"month\",\n        \"value-format\": \"YYYY-MM\"\n      }, null, 8 /* PROPS */, [\"modelValue\"])]),\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_form_item, null, {\n      default: _withCtx(() => [_createVNode(_component_el_button, {\n        type: \"primary\",\n        onClick: $setup.fetchReport\n      }, {\n        default: _withCtx(() => _cache[1] || (_cache[1] = [_createTextVNode(\"查询\")])),\n        _: 1 /* STABLE */,\n        __: [1]\n      }), _createVNode(_component_el_button, {\n        onClick: $setup.exportExcel\n      }, {\n        default: _withCtx(() => _cache[2] || (_cache[2] = [_createTextVNode(\"导出Excel\")])),\n        _: 1 /* STABLE */,\n        __: [2]\n      })]),\n      _: 1 /* STABLE */\n    })]),\n    _: 1 /* STABLE */\n  }), $setup.monthScore !== null ? (_openBlock(), _createBlock(_component_el_alert, {\n    key: 0,\n    title: `本月考勤绩效分：${$setup.monthScore}`,\n    type: \"success\",\n    \"show-icon\": \"\",\n    style: {\n      \"margin-bottom\": \"18px\"\n    }\n  }, null, 8 /* PROPS */, [\"title\"])) : _createCommentVNode(\"v-if\", true), _createVNode(_component_el_row, {\n    gutter: 20,\n    style: {\n      \"margin-bottom\": \"18px\"\n    }\n  }, {\n    default: _withCtx(() => [_createVNode(_component_el_col, {\n      span: 4\n    }, {\n      default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_1, \"出勤：\" + _toDisplayString($setup.report.attend), 1 /* TEXT */)]),\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_col, {\n      span: 4\n    }, {\n      default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_2, \"迟到：\" + _toDisplayString($setup.report.late), 1 /* TEXT */)]),\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_col, {\n      span: 4\n    }, {\n      default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_3, \"早退：\" + _toDisplayString($setup.report.early), 1 /* TEXT */)]),\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_col, {\n      span: 4\n    }, {\n      default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_4, \"缺卡：\" + _toDisplayString($setup.report.absent), 1 /* TEXT */)]),\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_col, {\n      span: 4\n    }, {\n      default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_5, \"请假：\" + _toDisplayString($setup.report.leave), 1 /* TEXT */)]),\n      _: 1 /* STABLE */\n    })]),\n    _: 1 /* STABLE */\n  }), _createVNode(_component_el_table, {\n    data: $setup.detailList,\n    border: \"\",\n    stripe: \"\",\n    style: {\n      \"margin-bottom\": \"18px\"\n    }\n  }, {\n    default: _withCtx(() => [_createVNode(_component_el_table_column, {\n      prop: \"date\",\n      label: \"日期\",\n      width: \"110\"\n    }), _createVNode(_component_el_table_column, {\n      prop: \"checkIn\",\n      label: \"签到时间\",\n      width: \"120\"\n    }), _createVNode(_component_el_table_column, {\n      prop: \"checkOut\",\n      label: \"签退时间\",\n      width: \"120\"\n    }), _createVNode(_component_el_table_column, {\n      prop: \"status\",\n      label: \"状态\",\n      width: \"90\"\n    }, {\n      default: _withCtx(scope => [_createElementVNode(\"span\", {\n        class: _normalizeClass($setup.statusClass(scope.row.status))\n      }, _toDisplayString($setup.statusText(scope.row.status)), 3 /* TEXT, CLASS */)]),\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_table_column, {\n      prop: \"performanceScore\",\n      label: \"绩效分数\",\n      width: \"100\"\n    })]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"data\"])]);\n}","map":{"version":3,"names":["class","_createElementBlock","_createVNode","_component_el_form","inline","style","default","_withCtx","_component_el_form_item","label","_component_el_date_picker","modelValue","$setup","month","_cache","$event","type","_","_component_el_button","onClick","fetchReport","_createTextVNode","__","exportExcel","monthScore","_createBlock","_component_el_alert","key","title","_createCommentVNode","_component_el_row","gutter","_component_el_col","span","_createElementVNode","_hoisted_1","_toDisplayString","report","attend","_hoisted_2","late","_hoisted_3","early","_hoisted_4","absent","_hoisted_5","leave","_component_el_table","data","detailList","border","stripe","_component_el_table_column","prop","width","scope","_normalizeClass","statusClass","row","status","statusText"],"sources":["D:\\web_code\\zxyf\\test_vue\\src\\components\\AttendanceReport.vue"],"sourcesContent":["<template>\n  <div>\n    <el-form :inline=\"true\" style=\"margin-bottom: 18px;\">\n      <el-form-item label=\"月份\">\n        <el-date-picker v-model=\"month\" type=\"month\" value-format=\"YYYY-MM\" />\n      </el-form-item>\n      <el-form-item>\n        <el-button type=\"primary\" @click=\"fetchReport\">查询</el-button>\n        <el-button @click=\"exportExcel\">导出Excel</el-button>\n      </el-form-item>\n    </el-form>\n    <el-alert v-if=\"monthScore !== null\" :title=\"`本月考勤绩效分：${monthScore}`\" type=\"success\" show-icon style=\"margin-bottom: 18px;\" />\n    <el-row :gutter=\"20\" style=\"margin-bottom: 18px;\">\n      <el-col :span=\"4\"><div class=\"stat-block attend\">出勤：{{ report.attend }}</div></el-col>\n      <el-col :span=\"4\"><div class=\"stat-block late\">迟到：{{ report.late }}</div></el-col>\n      <el-col :span=\"4\"><div class=\"stat-block early\">早退：{{ report.early }}</div></el-col>\n      <el-col :span=\"4\"><div class=\"stat-block absent\">缺卡：{{ report.absent }}</div></el-col>\n      <el-col :span=\"4\"><div class=\"stat-block leave\">请假：{{ report.leave }}</div></el-col>\n    </el-row>\n    <el-table :data=\"detailList\" border stripe style=\"margin-bottom: 18px;\">\n      <el-table-column prop=\"date\" label=\"日期\" width=\"110\" />\n      <el-table-column prop=\"checkIn\" label=\"签到时间\" width=\"120\" />\n      <el-table-column prop=\"checkOut\" label=\"签退时间\" width=\"120\" />\n      <el-table-column prop=\"status\" label=\"状态\" width=\"90\">\n        <template #default=\"scope\">\n          <span :class=\"statusClass(scope.row.status)\">{{ statusText(scope.row.status) }}</span>\n        </template>\n      </el-table-column>\n      <el-table-column prop=\"performanceScore\" label=\"绩效分数\" width=\"100\" />\n    </el-table>\n  </div>\n</template>\n\n<script setup>\nimport { ref, onMounted } from 'vue'\nimport axios from 'axios'\nimport { ElMessage } from 'element-plus'\n\nconst month = ref(new Date().toISOString().slice(0, 7))\nconst report = ref({ attend: 0, late: 0, early: 0, absent: 0, leave: 0 })\nconst detailList = ref([])\nconst monthScore = ref(null)\n\nconst fetchReport = async () => {\n  // 假设后端接口 /attendance/report?month=YYYY-MM\n  const { data } = await axios.get('/attendance/report', { params: { month: month.value } })\n  if (data.code === 1) {\n    report.value = data.data.summary\n    detailList.value = data.data.detail\n    fetchMonthScore()\n  } else {\n    ElMessage.error(data.msg || '获取报表失败')\n  }\n}\nconst fetchMonthScore = async () => {\n  const { data } = await axios.get('/attendance/month-score', { params: { month: month.value } })\n  if (data.code === 1) {\n    monthScore.value = data.data\n  } else {\n    monthScore.value = null\n  }\n}\nconst exportExcel = async () => {\n  try {\n    // 自动带token\n    const token = localStorage.getItem('token')\n    const res = await axios.get('/attendance/export', {\n      params: { month: month.value },\n      responseType: 'blob',\n      headers: token ? { token } : {}\n    })\n    // 处理文件名（兼容中文）\n    let fileName = `考勤报表_${month.value}.xlsx`\n    const disposition = res.headers && (res.headers['content-disposition'] || res.headers['Content-Disposition'])\n    if (disposition) {\n      const match = disposition.match(/filename\\*=UTF-8''(.+)/)\n      if (match) fileName = decodeURIComponent(match[1])\n      else {\n        const match2 = disposition.match(/filename=\"?([^\";]+)\"?/)\n        if (match2) fileName = decodeURIComponent(match2[1])\n      }\n    }\n    const blob = new Blob([res.data], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' })\n    const url = window.URL.createObjectURL(blob)\n    const a = document.createElement('a')\n    a.href = url\n    a.download = fileName\n    document.body.appendChild(a)\n    a.click()\n    document.body.removeChild(a)\n    window.URL.revokeObjectURL(url)\n  } catch (e) {\n    ElMessage.error('导出失败，请联系管理员！')\n  }\n}\nconst statusText = (status) => {\n  switch (status) {\n    case 1: return '正常';\n    case 2: return '迟到';\n    case 3: return '早退';\n    case 4: return '缺卡';\n    case 5: return '请假';\n    default: return '未知';\n  }\n}\nconst statusClass = (status) => {\n  switch (status) {\n    case 1: return 'attendance-status-normal'\n    case 2: return 'attendance-status-late'\n    case 3: return 'attendance-status-early'\n    case 4: return 'attendance-status-absent'\n    case 5: return 'attendance-status-leave'\n    default: return ''\n  }\n}\nonMounted(() => { fetchReport(); fetchMonthScore(); })\n</script>\n\n<style scoped>\n.stat-block {\n  background: linear-gradient(135deg, #e0eafc 60%, #cfdef3 100%);\n  border-radius: 8px;\n  padding: 10px 0;\n  font-size: 15px;\n  text-align: center;\n  margin-bottom: 6px;\n  color: #409EFF;\n  font-weight: bold;\n  box-shadow: 0 1px 4px rgba(64,158,255,0.05);\n}\n.stat-block.attend { background: linear-gradient(135deg, #e8f8ef 60%, #d2f4e5 100%); color: #219150; }\n.stat-block.late { background: linear-gradient(135deg, #fff6e5 60%, #ffe6c7 100%); color: #b26a00; }\n.stat-block.early { background: linear-gradient(135deg, #ffeaea 60%, #ffd6d6 100%); color: #c0392b; }\n.stat-block.absent { background: linear-gradient(135deg, #f4f4f5 60%, #e0e0e0 100%); color: #606266; }\n.stat-block.leave { background: linear-gradient(135deg, #e6f4ff 60%, #c7e6ff 100%); color: #1765ad; }\n.attendance-status-normal { color: #219150; font-weight: bold; }\n.attendance-status-late { color: #b26a00; font-weight: bold; }\n.attendance-status-early { color: #c0392b; font-weight: bold; }\n.attendance-status-absent { color: #606266; font-weight: bold; }\n.attendance-status-leave { color: #1765ad; font-weight: bold; }\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}