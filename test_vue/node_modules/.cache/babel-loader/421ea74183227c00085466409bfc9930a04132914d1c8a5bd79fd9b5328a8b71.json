{"ast":null,"code":"import { createRouter, createWebHistory } from 'vue-router';\nimport EmployeeHome from '../components/Home.vue';\nimport DepartmentManage from '../components/Dept.vue';\nimport EmployeeManage from '../components/Emp.vue';\nimport Login from '../components/Login.vue';\nimport Profile from '../components/Profile.vue';\nimport ChangePassword from '../components/ChangePassword.vue';\nimport Leave from '../components/Leave.vue';\nimport EmpVoice from '../components/EmpVoice.vue';\nimport Announcement from '../components/Announcement.vue';\nimport NotificationList from '../components/NotificationList.vue';\nconst routes = [{\n  path: '/home',\n  component: EmployeeHome\n}, {\n  path: '/dept',\n  component: DepartmentManage,\n  meta: {\n    requiresAuth: true\n  }\n}, {\n  path: '/emp',\n  component: EmployeeManage,\n  meta: {\n    requiresAuth: true\n  }\n}, {\n  path: '/login',\n  component: Login\n}, {\n  path: '/attendance',\n  component: () => import('@/components/Attendance.vue'),\n  meta: {\n    requiresAuth: true\n  }\n}, {\n  path: '/profile',\n  component: Profile\n},\n// { path: '/change-password', component: () => import('@/components/ChangePassword.vue') }, // 已集成到个人信息页面\n{\n  path: '/leave-approval',\n  component: () => import('@/components/LeaveApproval.vue')\n}, {\n  path: '/leave',\n  component: Leave\n}, {\n  path: '/voice',\n  component: EmpVoice\n}, {\n  path: '/announcement',\n  component: Announcement,\n  meta: {\n    requiresAuth: true,\n    requiresAdmin: true\n  }\n}, {\n  path: '/announcement/update',\n  component: Announcement,\n  meta: {\n    requiresAuth: true,\n    requiresAdmin: true\n  }\n}, {\n  path: '/notification',\n  component: NotificationList,\n  meta: {\n    requiresAuth: true\n  }\n}, {\n  path: '/',\n  redirect: '/home'\n}];\nconst router = createRouter({\n  history: createWebHistory(),\n  routes\n});\nrouter.beforeEach((to, from, next) => {\n  const token = localStorage.getItem('token');\n  const user = localStorage.getItem('user') ? JSON.parse(localStorage.getItem('user')) : {};\n  const isAdmin = user && user.username === 'admin';\n  if (!token && to.path !== '/login' && to.path !== '/register') {\n    // 未登录，强制跳转登录页\n    next('/login');\n  } else if (token && (to.path === '/login' || to.path === '/register')) {\n    // 已登录，不能访问登录/注册页\n    next('/');\n  } else if (to.meta.requiresAdmin && !isAdmin) {\n    // 需要管理员权限但当前用户不是管理员\n    next('/home');\n  } else {\n    next();\n  }\n});\nexport default router;","map":{"version":3,"names":["createRouter","createWebHistory","EmployeeHome","DepartmentManage","EmployeeManage","Login","Profile","ChangePassword","Leave","EmpVoice","Announcement","NotificationList","routes","path","component","meta","requiresAuth","requiresAdmin","redirect","router","history","beforeEach","to","from","next","token","localStorage","getItem","user","JSON","parse","isAdmin","username"],"sources":["D:/web_code/zxyf/test_vue/src/router/index.js"],"sourcesContent":["import { createRouter, createWebHistory } from 'vue-router'\nimport EmployeeHome from '../components/Home.vue'\nimport DepartmentManage from '../components/Dept.vue'\nimport EmployeeManage from '../components/Emp.vue'\nimport Login from '../components/Login.vue'\nimport Profile from '../components/Profile.vue'\nimport ChangePassword from '../components/ChangePassword.vue'\nimport Leave from '../components/Leave.vue'\nimport EmpVoice from '../components/EmpVoice.vue'\nimport Announcement from '../components/Announcement.vue'\nimport NotificationList from '../components/NotificationList.vue'\n\nconst routes = [\n  { path: '/home', component: EmployeeHome },\n  { path: '/dept', component: DepartmentManage, meta: { requiresAuth: true } },\n  { path: '/emp', component: EmployeeManage, meta: { requiresAuth: true } },\n  { path: '/login', component: Login },\n  { path: '/attendance', component: () => import('@/components/Attendance.vue'), meta: { requiresAuth: true } },\n  { path: '/profile', component: Profile },\n  // { path: '/change-password', component: () => import('@/components/ChangePassword.vue') }, // 已集成到个人信息页面\n  { path: '/leave-approval', component: () => import('@/components/LeaveApproval.vue') },\n  { path: '/leave', component: Leave },\n  { path: '/voice', component: EmpVoice },\n  { path: '/announcement', component: Announcement, meta: { requiresAuth: true, requiresAdmin: true } },\n  { path: '/announcement/update', component: Announcement, meta: { requiresAuth: true, requiresAdmin: true } },\n  { path: '/notification', component: NotificationList, meta: { requiresAuth: true } },\n  { path: '/', redirect: '/home' }\n]\n\nconst router = createRouter({\n  history: createWebHistory(),\n  routes\n})\n\nrouter.beforeEach((to, from, next) => {\n  const token = localStorage.getItem('token')\n  const user = localStorage.getItem('user') ? JSON.parse(localStorage.getItem('user')) : {}\n  const isAdmin = user && user.username === 'admin'\n\n  if (!token && to.path !== '/login' && to.path !== '/register') {\n    // 未登录，强制跳转登录页\n    next('/login')\n  } else if (token && (to.path === '/login' || to.path === '/register')) {\n    // 已登录，不能访问登录/注册页\n    next('/')\n  } else if (to.meta.requiresAdmin && !isAdmin) {\n    // 需要管理员权限但当前用户不是管理员\n    next('/home')\n  } else {\n    next()\n  }\n})\n\nexport default router\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}