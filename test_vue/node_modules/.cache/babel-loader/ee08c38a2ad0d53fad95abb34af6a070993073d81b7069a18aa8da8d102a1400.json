{"ast":null,"code":"import { ref, computed, onMounted } from 'vue';\nimport axios from 'axios';\nimport { ElMessage } from 'element-plus';\nimport { Check, Close } from '@element-plus/icons-vue';\nexport default {\n  __name: 'LeaveApproval',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const leaveList = ref([]);\n    const loading = ref(false);\n    const statusFilter = ref('all');\n    const filteredLeaveList = computed(() => {\n      if (statusFilter.value === 'all') return leaveList.value;\n      const statusMap = {\n        pending: 0,\n        approved: 1,\n        rejected: 2\n      };\n      return leaveList.value.filter(item => item.status === statusMap[statusFilter.value]);\n    });\n    const fetchLeaves = async () => {\n      loading.value = true;\n      try {\n        const res = await axios.get('/leave/all', {\n          headers: {\n            token: localStorage.getItem('token')\n          }\n        });\n        if (res.data.code === 1) {\n          leaveList.value = res.data.data;\n        }\n      } finally {\n        loading.value = false;\n      }\n    };\n    const approve = async (id, status) => {\n      try {\n        const res = await axios.post('/leave/approve', null, {\n          params: {\n            id,\n            status\n          },\n          headers: {\n            token: localStorage.getItem('token')\n          }\n        });\n        if (res.data.code === 1) {\n          ElMessage.success('审批成功');\n          fetchLeaves();\n        } else {\n          ElMessage.error(res.data.msg || '审批失败');\n        }\n      } catch (error) {\n        ElMessage.error('操作失败，请重试');\n      }\n    };\n    const getStatusType = status => {\n      switch (status) {\n        case 0:\n          return 'warning';\n        case 1:\n          return 'success';\n        case 2:\n          return 'danger';\n        default:\n          return 'info';\n      }\n    };\n    const getStatusText = status => {\n      switch (status) {\n        case 0:\n          return '待审批';\n        case 1:\n          return '已通过';\n        case 2:\n          return '已拒绝';\n        default:\n          return '未知';\n      }\n    };\n    const handleFilterChange = () => {\n      // 可以在这里添加额外的过滤逻辑\n    };\n    const handleImageError = e => {\n      e.target.style.display = 'none';\n      e.target.nextElementSibling.style.display = 'block';\n    };\n    onMounted(fetchLeaves);\n    const __returned__ = {\n      leaveList,\n      loading,\n      statusFilter,\n      filteredLeaveList,\n      fetchLeaves,\n      approve,\n      getStatusType,\n      getStatusText,\n      handleFilterChange,\n      handleImageError,\n      ref,\n      computed,\n      onMounted,\n      get axios() {\n        return axios;\n      },\n      get ElMessage() {\n        return ElMessage;\n      },\n      get Check() {\n        return Check;\n      },\n      get Close() {\n        return Close;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","computed","onMounted","axios","ElMessage","Check","Close","leaveList","loading","statusFilter","filteredLeaveList","value","statusMap","pending","approved","rejected","filter","item","status","fetchLeaves","res","get","headers","token","localStorage","getItem","data","code","approve","id","post","params","success","error","msg","getStatusType","getStatusText","handleFilterChange","handleImageError","e","target","style","display","nextElementSibling"],"sources":["D:/web_code/zxyf/test_vue/src/components/LeaveApproval.vue"],"sourcesContent":["<!-- eslint-disable vue/multi-word-component-names -->\n<template>\n  <div class=\"approval-container\">\n    <el-card class=\"approval-card\">\n      <template #header>\n        <div class=\"card-header\">\n          <span class=\"header-title\">请假审批</span>\n          <div class=\"header-desc\">管理员工的请假申请</div>\n        </div>\n      </template>\n\n      <div class=\"filter-section\">\n        <el-radio-group v-model=\"statusFilter\" @change=\"handleFilterChange\">\n          <el-radio-button label=\"all\">全部</el-radio-button>\n          <el-radio-button label=\"pending\">待审批</el-radio-button>\n          <el-radio-button label=\"approved\">已通过</el-radio-button>\n          <el-radio-button label=\"rejected\">已拒绝</el-radio-button>\n        </el-radio-group>\n      </div>\n\n      <el-table \n        :data=\"filteredLeaveList\" \n        style=\"width: 100%\" \n        v-loading=\"loading\"\n        :header-cell-style=\"{ background: '#f5f7fa', color: '#606266' }\"\n      >\n        <el-table-column prop=\"name\" label=\"姓名\" width=\"100\">\n          <template #default=\"scope\">\n            <div class=\"employee-info\">\n              <img \n                v-if=\"scope.row.image\" \n                :src=\"scope.row.image\" \n                style=\"width:32px;height:32px;border-radius:50%;object-fit:cover;\"\n                @error=\"handleImageError\"\n              />\n              <el-avatar v-else :size=\"32\">\n                {{ scope.row.name?.charAt(0)?.toUpperCase() }}\n              </el-avatar>\n              <span>{{ scope.row.name }}</span>\n            </div>\n          </template>\n        </el-table-column>\n        <el-table-column prop=\"startDate\" label=\"开始日期\" width=\"120\" />\n        <el-table-column prop=\"endDate\" label=\"结束日期\" width=\"120\" />\n        <el-table-column prop=\"reason\" label=\"请假原因\" show-overflow-tooltip />\n        <el-table-column prop=\"status\" label=\"状态\" width=\"100\">\n          <template #default=\"scope\">\n            <el-tag :type=\"getStatusType(scope.row.status)\" effect=\"light\">\n              {{ getStatusText(scope.row.status) }}\n            </el-tag>\n          </template>\n        </el-table-column>\n        <el-table-column label=\"操作\" width=\"180\" fixed=\"right\">\n          <template #default=\"scope\">\n            <div class=\"action-buttons\">\n              <el-button \n                v-if=\"scope.row.status === 0\"\n                type=\"success\" \n                size=\"small\" \n                @click=\"approve(scope.row.id, 1)\"\n                class=\"approve-btn\"\n              >\n                <el-icon><Check /></el-icon>同意\n              </el-button>\n              <el-button \n                v-if=\"scope.row.status === 0\"\n                type=\"danger\" \n                size=\"small\" \n                @click=\"approve(scope.row.id, 2)\"\n                class=\"reject-btn\"\n              >\n                <el-icon><Close /></el-icon>拒绝\n              </el-button>\n            </div>\n          </template>\n        </el-table-column>\n      </el-table>\n    </el-card>\n  </div>\n</template>\n\n<script setup>\nimport { ref, computed, onMounted } from 'vue'\nimport axios from 'axios'\nimport { ElMessage } from 'element-plus'\nimport { Check, Close } from '@element-plus/icons-vue'\n\nconst leaveList = ref([])\nconst loading = ref(false)\nconst statusFilter = ref('all')\n\nconst filteredLeaveList = computed(() => {\n  if (statusFilter.value === 'all') return leaveList.value\n  const statusMap = {\n    pending: 0,\n    approved: 1,\n    rejected: 2\n  }\n  return leaveList.value.filter(item => item.status === statusMap[statusFilter.value])\n})\n\nconst fetchLeaves = async () => {\n  loading.value = true\n  try {\n    const res = await axios.get('/leave/all', { headers: { token: localStorage.getItem('token') } })\n    if (res.data.code === 1) {\n      leaveList.value = res.data.data\n    }\n  } finally {\n    loading.value = false\n  }\n}\n\nconst approve = async (id, status) => {\n  try {\n    const res = await axios.post('/leave/approve', null, { \n      params: { id, status }, \n      headers: { token: localStorage.getItem('token') } \n    })\n    if (res.data.code === 1) {\n      ElMessage.success('审批成功')\n      fetchLeaves()\n    } else {\n      ElMessage.error(res.data.msg || '审批失败')\n    }\n  } catch (error) {\n    ElMessage.error('操作失败，请重试')\n  }\n}\n\nconst getStatusType = (status) => {\n  switch (status) {\n    case 0: return 'warning'\n    case 1: return 'success'\n    case 2: return 'danger'\n    default: return 'info'\n  }\n}\n\nconst getStatusText = (status) => {\n  switch (status) {\n    case 0: return '待审批'\n    case 1: return '已通过'\n    case 2: return '已拒绝'\n    default: return '未知'\n  }\n}\n\nconst handleFilterChange = () => {\n  // 可以在这里添加额外的过滤逻辑\n}\n\nconst handleImageError = (e) => {\n  e.target.style.display = 'none'\n  e.target.nextElementSibling.style.display = 'block'\n}\n\nonMounted(fetchLeaves)\n</script>\n\n<style scoped>\n.approval-container {\n  padding: 20px;\n}\n\n.approval-card {\n  border-radius: 16px;\n  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);\n  transition: all 0.3s ease;\n}\n\n.approval-card:hover {\n  transform: translateY(-2px);\n  box-shadow: 0 6px 24px rgba(0, 0, 0, 0.08);\n}\n\n.card-header {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n\n.header-title {\n  font-size: 20px;\n  font-weight: bold;\n  color: #409EFF;\n}\n\n.header-desc {\n  font-size: 14px;\n  color: #909399;\n}\n\n.filter-section {\n  margin-bottom: 20px;\n}\n\n.employee-info {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.employee-info :deep(.el-avatar) {\n  background: linear-gradient(135deg, #409EFF 0%, #36D1DC 100%);\n  color: #fff;\n  font-weight: bold;\n}\n\n.action-buttons {\n  display: flex;\n  gap: 8px;\n}\n\n.approve-btn, .reject-btn {\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  border-radius: 4px;\n  font-weight: bold;\n  transition: all 0.3s ease;\n}\n\n.approve-btn:hover {\n  transform: translateY(-2px);\n  box-shadow: 0 4px 12px rgba(103, 194, 58, 0.3);\n}\n\n.reject-btn:hover {\n  transform: translateY(-2px);\n  box-shadow: 0 4px 12px rgba(245, 108, 108, 0.3);\n}\n\n:deep(.el-table) {\n  border-radius: 8px;\n  overflow: hidden;\n}\n\n:deep(.el-table th) {\n  background-color: #f5f7fa;\n  font-weight: bold;\n}\n\n:deep(.el-tag) {\n  border-radius: 4px;\n  padding: 0 12px;\n  height: 24px;\n  line-height: 24px;\n  font-weight: bold;\n}\n\n:deep(.el-radio-button__inner) {\n  border-radius: 4px;\n  padding: 8px 16px;\n  font-weight: bold;\n}\n\n:deep(.el-radio-button__original-radio:checked + .el-radio-button__inner) {\n  box-shadow: 0 2px 8px rgba(64, 158, 255, 0.3);\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}